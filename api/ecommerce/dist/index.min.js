var C=Object.create;var f=Object.defineProperty;var P=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var T=Object.getPrototypeOf,k=Object.prototype.hasOwnProperty;var _=(t,r,o,s)=>{if(r&&typeof r=="object"||typeof r=="function")for(let e of x(r))!k.call(t,e)&&e!==o&&f(t,e,{get:()=>r[e],enumerable:!(s=P(r,e))||s.enumerable});return t};var y=(t,r,o)=>(o=t!=null?C(T(t)):{},_(r||!t||!t.__esModule?f(o,"default",{value:t,enumerable:!0}):o,t));var F=y(require("@groupclaes/fastify-elastic"));var d=y(require("mssql"));var h=require("mssql"),g=require("./config"),a=new Map,n={get:async t=>{if(!a.has(t)){if(!g.mssql[t])throw new Error(`Configuration for pool '${t}' does not exist!`);let r=new h.ConnectionPool(g.mssql[t]),o=r.close.bind(r);r.close=(...s)=>(a.delete(t),o(...s)),a.set(t,await r.connect())}return a.get(t)},closeAll:()=>Promise.all(Array.from(a.values()).map(t=>t.then(r=>r.close())))};var J="brabopak",c=class{constructor(){this.schema="[ecommerce]."}async getTree(r,o="nl"){try{let s=new d.default.Request(await n.get(J));s.input("user_id",d.default.Int,r),s.input("culture",d.default.VarChar,o);let e=await s.execute(this.schema+"[usp_getCategoriesTree]");return e.recordset.length>0?e.recordset[0]:void 0}catch(s){throw s}}};var b=async(t,r)=>{try{let o=new c,s=t.token||{sub:null},e=t.query.culture??"nl";return await o.getTree(s.sub,e)}catch(o){return r.status(500).send(o)}};var l=y(require("mssql"));var E="brabopak",i=class{constructor(){this.schema="[ecommerce]."}async get(r,o,s="nl"){try{let e=new l.default.Request(await n.get(E));e.input("user_id",l.default.Int,o),e.input("usercode",l.default.Int,r),e.input("culture",l.default.VarChar,s);let u=await e.execute(this.schema+"[usp_getCart]");return u.recordset.length>0?u.recordset[0]:void 0}catch(e){throw e}}};var w=async(t,r)=>{try{let o=new i,s=t.token||{sub:null},e=t.query.culture??"nl"}catch(o){return r.status(500).send(o)}};var m=y(require("mssql"));var D="brabopak",p=class{constructor(){this.schema="[ecommerce]."}async get(r,o,s="nl"){try{let e=new m.default.Request(await n.get(D));e.input("user_id",m.default.Int,o),e.input("usercode",m.default.Int,r),e.input("culture",m.default.VarChar,s);let u=await e.execute(this.schema+"[usp_getDashboard]");return u.recordset.length>0?u.recordsets:void 0}catch(e){throw e}}};var R=async(t,r)=>{try{let o=new p,s=t.token||{sub:null},e=t.query.culture??"nl";return await o.get(t.query.usercode,s.sub,e)}catch(o){return r.status(500).send(o)}};var q=[{method:"GET",url:"/menu",handler:b},{method:"GET",url:"/carts",handler:w},{method:"GET",url:"/dashboard",handler:R}];var M=require("./config"),Q=async()=>{let t=new F.default(M.wrapper);t.routeMultiple(q),await t.start()};Q();
